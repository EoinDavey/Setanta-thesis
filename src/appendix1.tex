\documentclass[11pt]{extarticle}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[a4paper, margin=25mm]{geometry}
\usepackage{fancyhdr}
\usepackage{textcomp}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{float}
\floatstyle{boxed} 
\restylefloat{figure}
\graphicspath{ {src/} }
\newcommand{\Setanta}{\emph{Setanta}}
\newcommand{\tsPEG}{\emph{tsPEG}}
\newcommand{\trys}{\href{https://try-setanta.ie}{try-setanta.ie}}
\renewcommand{\baselinestretch}{1.5}
\hypersetup{
    colorlinks=true,
    urlcolor=blue,
}
\lstset
{
    numbers=left,
    basicstyle=\footnotesize,
    showstringspaces=false,
    breaklines=true,
    keywordstyle=\color{blue}\bfseries,
    stringstyle=\ttfamily,
    inputencoding=utf8,
    extendedchars=true,
    literate=%
        {á}{{\'a}}1
        {ó}{{\'o}}1
        {é}{{\'e}}1
        {í}{{\'i}}1
        {ú}{{\'u}}1
        {má}{{{\color{blue}\textbf{m\'a}}}}2
        {nuair-a}{{{\color{blue}\textbf{nuair-a}}}}7
        {neamhní}{{{\color{purple}\textbf{neamhn\'i}}}}7
        {gníomh}{{{\color{blue}\textbf{gn\'iomh}}}}6
        {fíor}{{{\color{orange}f\'ior}}}4
        {breag}{{{\color{orange}breag}}}5
    }
\pagestyle{fancy}
\fancyhf{}
\rhead{\thepage}
\lhead{Eoin Davey - Final Year Project 2020 - 5 credits}
\def\chapinp#1{\input{src/chaps/#1}}
\begin{document}
    \title{Appendix 1}
    \author{Eoin Davey - 16634926}
    \date{}
    \maketitle
    \thispagestyle{fancy}
    \noindent This is the self-describing meta-grammar for \tsPEG{} that is used for the bootstrapping process. This grammar is defined in terms of itself, \tsPEG{} uses it to generate its input parser.
    \begin{figure}[ht]
        \caption{\tsPEG{} meta-grammar definition}
        \label{tspegsyntax}
        \begin{lstlisting}
GRAM      := header=HDR? rules=RULEDEF+
HDR       := '---' content='((?!---)(.|\n))*' '---'
RULEDEF   := _ name=NAME _ ':=' _ rule=RULE _
RULE      := head=ALT tail={_ '\|' _ alt=ALT }*
          .list = ALT[] { return [this.head, ...this.tail.map((x) => x.alt)]; }
ALT       := matches=MATCHSPEC+ attrs=ATTR*
MATCHSPEC := _ named={name=NAME _ '=' _}? rule=POSTOP _
POSTOP    := pre=PREOP op='\+|\*|\?'?
            .optional = boolean { return this.op !== null && this.op === '?'}
PREOP     := op='\&|!'? at=ATOM
ATOM      := name=NAME !'\s*:='
           | match=STRLIT
           | '{' _ sub=RULE _ '}'
ATTR      := _ '.' name=NAME _ '=' _ type='[^\s\{]+' _ '\{'
    action='([^\{\}\\]|(\\.))*'
'\}'
NAME      := '[a-zA-Z_]+'
STRLIT    := '\'' val='([^\'\\]|(\\.))*' '\''
_         := '\s*'
        \end{lstlisting}
    \end{figure}
\end{document}
